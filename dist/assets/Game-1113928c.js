import{_ as I,d as k,i as M,o as p,c as h,F as S,f as P,w as V,g as j,e as s,t as f,s as D,r as z,l as T,k as y,x as O,T as G,a as g,y as H,j as x,z as L,p as A,q as F,A as K,B as U,C as Z,b as J,R as Q}from"./index-2a2fa7c6.js";import{R as X,a as Y}from"./RuleGuidePente-709abd73.js";const ee={class:"board"},te=["data-coordinate","disabled"],ne={__name:"Board",props:{size:{type:Number,required:!0},isTurnWhite:Boolean,winner:String,indexEnabled:Boolean,gameType:String,players:{type:Array,default:["p1","p2"]}},emits:{played:String,win:String,capture:Number},setup(i,{emit:c}){const e=i,l=k(Array.from({length:e.size},()=>new Array(e.size)));function _(a){a.target.disabled=!0;const r=a.target.dataset.coordinate,[o,n]=r.split("-").map(u=>~~u),t=C(o+1,n+1);l.value[o][n].textContent=e.isTurnWhite?"⚪":"⚫",c("played",t);const v=$()([o,n]);if(v.length?(v.flat(1).forEach(u=>{l.value[u[0]][u[1]].dataset.bingo=!0}),c("win",e.isTurnWhite?e.players[1]:e.players[0])):l.value.flat(1).some(u=>u.textContent==="")||c("win","沒有人"),e.gameType==="pente"){const b=m()([o,n]);if(b.length){const R=b.map(([E,N])=>C(E+1,N+1));console.log(`${e.isTurnWhite?e.players[1]:e.players[0]}捕獲 @ :${R}`),c("capture",b.length),b.forEach(([E,N])=>{l.value[E][N].textContent="",l.value[E][N].disabled=!1})}}}function m(){const a=[],r=["NW","N","NE","W","E","SW","S","SE"];let o=r.length;return function n(t){o--;const d=[],v=e.isTurnWhite?["⚫","⚫","⚪"]:["⚪","⚪","⚫"];for(let u=1;u<4;u++){const b=w(t,r[o],u);b.length&&l.value[b[0]][b[1]].textContent===v[u-1]&&d.push(b)}return d.length===3&&a.push(d[0],d[1]),o>0?n(t):a}}function $(){const a={NW:[],N:[],NE:[],W:[],E:[],SW:[],S:[],SE:[]},r=Object.keys(a);let o=r.length;return function n(t){o--;let d=0,v=!0;for(;v;){d++;const u=w(t,r[o],d);if(!u.length)break;v=l.value[t[0]][t[1]].textContent===l.value[u[0]][u[1]].textContent,v&&a[r[o]].push(u)}return o>0?n(t):[[...a.E,t,...a.W],[...a.NE,t,...a.SW],[...a.N,t,...a.S],[...a.NW,t,...a.SE]].filter(u=>u.length>=5)}}function w(a,r,o){const[n,t]=a,d=r==="E"?[n+o,t]:r==="NE"?[n+o,t+o]:r==="N"?[n,t+o]:r==="NW"?[n-o,t+o]:r==="W"?[n-o,t]:r==="SW"?[n-o,t-o]:r==="S"?[n,t-o]:r==="SE"?[n+o,t-o]:[];return d.every(u=>u>=0&&u<e.size)?d:[]}function C(a,r){return r>26?`${r}-${a}`:String.fromCodePoint(64+r)+a}return M(()=>{const a=Math.floor(e.size/2);e.gameType==="pente"&&(l.value[a][a].textContent="⚪",l.value[a][a].disabled=!0)}),(a,r)=>(p(),h("div",ee,[(p(!0),h(S,null,P(e.size,o=>(p(),h(S,{key:o},[(p(!0),h(S,null,P(e.size,n=>{var t;return p(),h("div",{key:n,class:"cell-wrap"},[V(s("span",{class:"tags"},f(C(o,n)),513),[[j,i.indexEnabled]]),s("button",{class:"cell","data-coordinate":`${o-1}-${n-1}`,ref_for:!0,ref:d=>l.value[o-1][n-1]=d,disabled:!!e.winner,onClick:_},f((t=l.value[o-1][n-1])==null?void 0:t.textContent),9,te)])}),128))],64))),128))]))}},se=I(ne,[["__scopeId","data-v-98c56399"]]),oe={__name:"Timer",props:{time:{type:Number,required:!0}},emits:{countdown:Number},setup(i,{expose:c,emit:e}){const l=i,_=k(l.time),m=k(0);function $(){m.value=setInterval(()=>{e("countdown",_.value),_.value>0?_.value--:w()},1e3)}function w(){clearInterval(m.value),m.value=0}function C(){w(),_.value=l.time,$()}return c({resume:$,pause:w,reset:C}),M(()=>{$()}),D(()=>{w()}),(a,r)=>z(a.$slots,"default",{time:_.value,isRunning:m.value>0,pause:w,resume:$,reset:C})}};const ae={key:0,class:"modal-mask"},le={class:"modal-container"},re={class:"modal-header"},ie={class:"modal-body"},ue={class:"modal-footer"},B={__name:"Modal",props:{show:Boolean},setup(i){return(c,e)=>(p(),T(G,{name:"modal"},{default:y(()=>[i.show?(p(),h("div",ae,[s("div",le,[s("div",re,[z(c.$slots,"header",{},()=>[g("default header")])]),s("div",ie,[z(c.$slots,"body",{},()=>[g("default body")])]),s("div",ue,[z(c.$slots,"footer",{},()=>[s("button",{class:"modal-default-button",onClick:e[0]||(e[0]=l=>c.$emit("close"))},"OK")])])])])):O("",!0)]),_:3}))}};const q=i=>(A("data-v-6164ee2e"),i=i(),F(),i),ce=q(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-list",viewBox:"0 0 16 16"},[s("path",{"fill-rule":"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})],-1)),de=[ce],pe={key:0,class:"wrap"},fe={class:"lists | flow"},me=q(()=>s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-x-lg",viewBox:"0 0 16 16"},[s("path",{d:"M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"})],-1)),_e=[me],he={__name:"MenuBtn",props:{show:Boolean,ruleGuide:String},setup(i){const c=k(!1);return(e,l)=>{const _=H("RouterLink");return p(),h(S,null,[s("button",{class:"hamburger",onClick:l[0]||(l[0]=m=>e.$emit("open"))},de),(p(),T(L,{to:"body"},[x(G,null,{default:y(()=>[i.show?(p(),h("div",pe,[s("ul",fe,[s("li",null,[x(_,{to:"/",class:"btn btn-primary"},{default:y(()=>[g("返回主頁")]),_:1})]),s("li",null,[s("a",{class:"btn btn-primary",onClick:l[1]||(l[1]=m=>c.value=!0)},"規則說明")])]),s("button",{onClick:l[2]||(l[2]=m=>e.$emit("close")),style:{color:"red"}},_e)])):O("",!0)]),_:1}),x(B,{show:c.value,onClose:l[3]||(l[3]=m=>c.value=!1)},{header:y(()=>[g(" 規則 ")]),body:y(()=>[i.ruleGuide==="pente"?(p(),T(X,{key:0})):(p(),T(Y,{key:1}))]),_:1},8,["show"])]))],64)}}},ve=I(he,[["__scopeId","data-v-6164ee2e"]]);const W=i=>(A("data-v-d31f2be6"),i=i(),F(),i),ye={class:"view | container-fluid"},be={class:"row align-items-stretch"},we={class:"panel | col-xl-3 col-12 row flex-xl-column align-items-center pt-3 g-0 flow"},ge={key:0,class:"my-auto"},$e={key:1,class:"my-auto"},Ce={class:"row col-10 col-xl-8 mx-auto px-0 py-3"},xe={class:"col-6"},Te=W(()=>s("br",null,null,-1)),ke={class:"player-point"},Se={class:"col-6"},We=W(()=>s("br",null,null,-1)),Ee={class:"player-point"},Ne=["disabled","onClick"],ze={style:{"font-size":"1.25rem"}},Be={key:3,class:"btn btn-gray | col-6 col-xl-8 mb-auto",disabled:""},Ie={class:"board | row col-xl-9 col-12 g-0"},Me=W(()=>s("h3",null,"超時落敗",-1)),Re=W(()=>s("p",null,"想太久嘍σ ﾟ∀ ﾟ) ﾟ∀ﾟ)σ",-1)),Pe=W(()=>s("h3",null,"恭喜！",-1)),Oe={__name:"Game",props:{size:Number,sec:Number,players:Array,roundType:String,gameType:String},setup(i){const c=i,e=K({winner:"",lastPlacement:"",gameType:c.gameType,isTurnWhite:!1,isTimeOut:!1,indexEnabled:!1,players:c.players,winCounts:[0,0],captures:[0,0],round:1,goalScore:c.roundType==="three-out-of-five"?3:c.roundType==="two-out-of-three"?2:1}),l=U(()=>e.winCounts.some(n=>n>=e.goalScore)),_=k(!1),m=k(null),$=n=>`
    ${Math.floor(n/60/10)}${Math.floor(n/60%10)}
    :
    ${Math.floor(n%60/10)}${Math.floor(n%60%10)}
  `;function w(n){if(n<=0){const t=e.isTurnWhite?e.players[0]:e.players[1];e.isTimeOut=!0,r(t)}}function C(n){const t=e.isTurnWhite?0:1;e.captures[t]+=n,e.captures.some(d=>d>=10)&&r(e.players[t])}function a(n){e.isTurnWhite=!e.isTurnWhite,e.lastPlacement=n,m.value.reset()}function r(n){e.winner=n,m.value.pause();const t=e.players.indexOf(e.winner);t>=0&&e.winCounts[t]++}function o(){e.round++,Object.assign(e,{isTurnWhite:!1,winner:"",lastPlacement:"",isTimeOut:!1,indexEnabled:!1,captures:[0,0]}),e.players.reverse(),e.winCounts.reverse(),e.captures.reverse()}return M(()=>{console.log(`棋盤大小：${c.size}`),document.getElementById("app").style.setProperty("--board-size",`${c.size}`),c.gameType==="pente"&&e.players.reverse()}),(n,t)=>(p(),h(S,null,[s("div",ye,[s("main",be,[s("section",we,[x(ve,{show:_.value,ruleGuide:i.gameType,onOpen:t[0]||(t[0]=d=>_.value=!0),onClose:t[1]||(t[1]=d=>_.value=!1)},null,8,["show","ruleGuide"]),e.winner?(p(),h("h2",ge,f(e.winner)+"獲勝",1)):(p(),h("h2",$e,"第"+f(e.round)+"回合",1)),s("div",Ce,[s("span",xe,[g(f(e.players[0])+" ⚫ ",1),Te,g(" "+f(`${e.winCounts[0]}勝`)+" ",1),s("strong",ke,f(i.gameType==="pente"?`  (補獲${e.captures[0]}/10)`:""),1)]),s("span",Se,[g(f(e.players[1])+" ⚪ ",1),We,g(" "+f(`${e.winCounts[1]}勝`)+" ",1),s("strong",Ee,f(i.gameType==="pente"?`  (補獲${e.captures[1]}/10)`:""),1)])]),(p(),T(oe,{ref_key:"timer",ref:m,time:i.sec,onCountdown:w,key:e.round},{default:y(({time:d,isRunning:v,pause:u,resume:b})=>[s("button",{class:"btn btn-sky | col-12 col-xl-8",disabled:!!e.winner,onClick:R=>v?u():b()},[s("h2",null,f($(d)),1),s("span",ze,f(v?"⏸️":"▶️"),1)],8,Ne)]),_:1},8,["time"])),s("button",{class:"btn btn-gray | col-6 col-xl-8",onPointerdown:t[2]||(t[2]=d=>e.indexEnabled=!0),onPointerup:t[3]||(t[3]=d=>e.indexEnabled=!1),onPointerleave:t[4]||(t[4]=d=>e.indexEnabled=!1)},f(e.isTurnWhite?e.players[0]:e.players[1])+" @ "+f(e.lastPlacement),33),e.winner?(p(),h("button",{key:2,class:"btn btn-gray | col-6 col-xl-8 mb-auto","data-bingo":"true",onClick:o}," 進入下一局 ")):(p(),h("button",Be,f(e.isTurnWhite?"⚪":"⚫")+" 的回合 ",1))]),s("section",Ie,[(p(),T(se,Z({size:i.size},e,{onWin:r,onPlayed:a,onCapture:C,key:e.round}),null,16,["size"]))])])]),(p(),T(L,{to:"body"},[x(B,{show:e.isTimeOut,onClose:t[5]||(t[5]=d=>e.isTimeOut=!1)},{header:y(()=>[Me]),body:y(()=>[Re]),_:1},8,["show"]),x(B,{show:l.value},{header:y(()=>[Pe]),body:y(()=>[s("p",null,f(e.winner)+"獲勝",1)]),footer:y(()=>[x(J(Q),{to:"/",class:"modal-default-button"},{default:y(()=>[g("回到主畫面")]),_:1})]),_:1},8,["show"])]))],64))}},Ae=I(Oe,[["__scopeId","data-v-d31f2be6"]]);export{Ae as default};
